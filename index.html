<!DOCTYPE html>
<html>
<head>
    <title>PDF to Excel Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 0 20px; }
        textarea { width: 100%; height: 300px; margin: 10px 0; }
        button { padding: 10px 20px; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0052a3; }
        .instructions { background: #f5f5f5; padding: 15px; border-radius: 4px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>PDF to Excel Converter</h1>
    
    <div class="instructions">
        <h3>Instructions:</h3>
        <ol>
            <li>Copy the content from your PDF</li>
            <li>Paste it into the textarea below</li>
            <li>Click "Convert to Excel"</li>
            <li>The Excel file will automatically download</li>
        </ol>
    </div>

    <textarea id="pdfContent" placeholder="Paste your PDF content here..."></textarea>
    <button onclick="convertToExcel()">Convert to Excel</button>

    <script>
        function processLine(line) {
            const regex = /(\S+(?:\s+\S+)*?)\s+(\d{4})\s+([\w\-]+)\s+€\s*(\d+(?:\.\d+)?)\s*(?:€\s*(\d+(?:\.\d+)?))?\s*(?:€\s*(\d+(?:\.\d+)?))?\s*(?:€\s*(\d+(?:\.\d+)?))?\s*(?:€\s*(\d+(?:\.\d+)?))?\s*(?:€\s*(\d+(?:\.\d+)?))?\s*/;
            const match = line.match(regex);
            
            if (match) {
                const [_, product, division, code, price1kg, price5kg, price10kg, price17_18kg, price20_25kg, price100kg] = match;
                
                const rows = [];
                
                if (price1kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '1kg',
                        'Price': parseFloat(price1kg)
                    });
                }
                if (price5kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '5kg',
                        'Price': parseFloat(price5kg)
                    });
                }
                if (price10kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '10kg',
                        'Price': parseFloat(price10kg)
                    });
                }
                if (price17_18kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '17-18kg',
                        'Price': parseFloat(price17_18kg)
                    });
                }
                if (price20_25kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '20-25kg',
                        'Price': parseFloat(price20_25kg)
                    });
                }
                if (price100kg) {
                    rows.push({
                        'Product': product.trim(),
                        'Product Code': code,
                        'Quantity': '100kg',
                        'Price': parseFloat(price100kg)
                    });
                }
                
                return rows;
            }
            return [];
        }

        function convertToExcel() {
            const content = document.getElementById('pdfContent').value;
            const lines = content.split('\n');
            const allRows = [];
            
            lines.forEach(line => {
                if (line.trim() && !line.includes('CONFIDENTIAL') && !line.includes('Division Product code')) {
                    const rows = processLine(line);
                    allRows.push(...rows);
                }
            });
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(allRows);
            
            // Add worksheet to workbook
            XLSX.utils.book_append_sheet(wb, ws, "Price Breaks");
            
            // Generate Excel file and trigger download
            XLSX.writeFile(wb, 'price_breaks.xlsx');
        }
    </script>
</body>
</html>
